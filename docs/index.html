<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Animation of Vibrational Modes of Dry Ice</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="bootstrap-4.0.0-beta.2-dist/css/bootstrap.css" media="screen">
    <link rel="stylesheet" href="css/my_style.css" media="screen">
    <link rel="stylesheet" href="css/glyphicons.css" media="screen">
    <link rel="stylesheet" href="bootstrap-slider/bootstrap-slider.css">

    <script src="plotly-latest.min.js"></script>
    <script type="text/javascript" src="jsmol/JSmol.min.js"></script>
    <script type="text/javascript" src="jmolvib.js"></script>
</head>
<body>
<div align="center" class="riga_tutorial"></div>
<div class="container">
    <div>
        <h2 id='titre'>Animation of Vibrational Modes of Dry Ice</h2>
        <h3 id='auth'></h3>
        <h6 id='cite'></h6>
    </div>
    <div class="row" style="margin-top: -20px;">
        <div class="col-md-4"></div>
        <div class="col-md-4">
            <div align="center">
                <div class="form-group" >
                    <br>
                    <label class="control-label">Select a file:</label>
                    <div class="input-group">
                        <input id="inputFile" type="file" onchange='openFile2(event)' class="filestyle" data-size="nr" data-buttonName="btn-primary"
                               data-placeholder="e.g. : file.out or file.xyz" data-iconName="glyphicon glyphicon-file" multiple>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-4"></div>
    </div>
    <div class="row">
        <div class="col-md-7">
            <div id="div_plotly">
                <div id="myDiv"><!-- Plotly chart will be drawn inside this DIV --></div>
                <div align="center" id="select_ir_raman">
                    Select spectrum type: &nbsp;&nbsp;
                    <input type="radio" name="spectraType" id="IR" checked="checked" OnClick='jmolIsReady(); changeTitlePlotly(0);'>IR
                    &nbsp;&nbsp;&nbsp;&nbsp;
                    <input type="radio" name="spectraType" id="Raman" OnClick='jmolIsReady(); changeTitlePlotly(1);'>Raman
                    <div align="center" id="howto">NB : Drag with your mouse in order to zoom. Double click to restore intial zoom.</div>
                </div>
            </div>
        </div>
        <div class="col-md-5">
            <div id="div_jsmol">
                <div id="caption"></div>
                <script>
                    if (withJmolFile) {
                        scr="script '"+jmolFileName+"';";
                    }
                    else {
                        scr="";
                    }
                    scr = "script '"dryice.out';";
                    Jmol.setAppletCss('jmolBox');
                    jmolApplet0=Jmol.getApplet("jmolApplet0", info);
                    Jmol.script(jmolApplet0, 'javascript init(scr); axes off; unitcell off;');
                </script>
            </div>
        </div>
    </div>
    <br>
    <div class="row" style="margin-bottom:10px;" >
        <div class="col-md-7">
            <div class="pannello_settings" id="pannello_sx">
                <div class="row">
                    <div class="col-md-4">
                        <h5>Modes</h5>
                        <select id="modes" size="15" class="select_opzioni_larghezza" onChange=listonchange();update()>
                            <option value="1">Modes</option>
                        </select>
                    </div>
                    <div class="col-md-4">
                        <h5>Filter modes</h5>
                        <input type="radio" name="Only" id="OnlyAll" value="All" OnClick=updateModes() checked="checked">All<br>
                        <input type="radio" name="Only" id="OnlyIR" value="IR" OnClick=updateModes()>IR <br>
                        <input type="radio" name="Only" id="OnlyRaman"value="Raman"  OnClick=updateModes()>Raman<br>
                        <input type="radio" name="Only" id="OnlySym" OnClick=updateModes()> Symmetry<br>
                        <br>
                        <select id="symmetries" size="5" class="select_opzioni_larghezza" OnClick=updateModes()>
                            <option value="1">Symmetry</option>
                        </select>
                        <br>
                        <br>
                        <div id="legend"></div>
                    </div>
                    <div class="col-md-4"></div>
                </div>
            </div>
        </div>
        <div class="col-md-5">
            <div class="pannello_settings">
                <h5>Vibrations</h5>
                <div>
                    <input type="checkbox" id="vib_on" checked="checked" OnClick='update()'>Animation
                    <span style="margin-left: 50px;">
                        Scale:
                        <input type="radio" name="anim_scale" id="as1" OnClick='update()'>1
                        &nbsp;&nbsp;
                        <input type="radio" name="anim_scale" id="as2" checked="checked"  OnClick='update()'>2
                        &nbsp;&nbsp;
                        <input type="radio" name="anim_scale" id="as3" OnClick='update()'>3
                    </span>
                </div>
                <div>
                    <input type="checkbox" id="vect_on"  OnClick='update()'>Vectors
                    <span style="margin-left: 71px;">
                        Scale:
                        <input type="radio" name="vect_scale" id="vs1" OnClick='update()'>1
                        &nbsp;&nbsp;
                        <input type="radio" name="vect_scale" id="vs2" checked="checked" OnClick='update()'>2
                        &nbsp;&nbsp;
                        <input type="radio" name="vect_scale" id="vs3" OnClick='update()'>3
                    </span>
                </div>
                <br>
                <h5>View</h5>
                <span id='cellCtrl'><input type="checkbox" id="cell"  OnClick='update()'>Cell</span>
                &nbsp;&nbsp;&nbsp;&nbsp;
                <input type="checkbox" id="persp"  OnClick='update()'>Perspective
                <br>
                Along
                &nbsp;&nbsp;&nbsp;&nbsp;
                <input type="button" name="along_x" id="along_x" value="x"
                       OnClick='Jmol.script(jmolApplet0,"moveto 1 0 -1000 0 90.0;")'>
                &nbsp;&nbsp;&nbsp;&nbsp;
                <input type="button" name="along_y" id="along_y" value="y"
                       OnClick='Jmol.script(jmolApplet0,"moveto 1 1000 0 0 90.0;")'>
                &nbsp;&nbsp;&nbsp;&nbsp;
                <input type="button" name="along_z" id="along_z" value="z"
                       OnClick='Jmol.script(jmolApplet0,"moveto 1 1 0 0 0;")'>
                <div id="view_perso"></div>
                <br>
                <div id="sizeAt">
                    <h5>Atoms size</h5>
                    <input type="radio" name="atsize" id="at_tiny" value=0 OnClick='update()'>Tiny
                    &nbsp;&nbsp;&nbsp;&nbsp;
                    <input type="radio" name="atsize" id="at_small" value=1 checked="checked"  OnClick='update()'>Small
                    &nbsp;&nbsp;&nbsp;&nbsp;
                    <input type="radio" name="atsize" id="at_normal" value=2 OnClick='update()'>Big<br><br>
                    <h5>Bond width</h5>
                    <input type="radio" name="bondsize" id="bond_tiny" value=0 checked="checked"  OnClick='update()'>Thin
                    &nbsp;&nbsp;&nbsp;&nbsp;
                    <input type="radio" name="bondsize" id="bond_small" value=1 OnClick='update()'>Thick
                </div>
            </div>
        </div>
    </div>
    <div style="font-style: italic;margin-bottom:20px;">
        <p style="float:left;">This page has been developed and designed by <a href="http://www.istep.upmc.fr/fr/les_equipes/pgm2/noel_yves.html" target="_blank">Yves No&euml;l</a>.</p>
        <p style="float:right;"><a href="https://www.stolaf.edu/people/hansonr/" target="_blank">Robert Hanson</a> is kindly acknowledged for his help with JMol plug-in to CRYSTAL.</p>
    </div>
</div>
<div align="center" class="riga_tutorial"></div>
</body>
<script src="jquery/jquery-1.10.2.min.js"></script>
<script src="bootstrap-4.0.0-beta.2-dist/js/bootstrap.bundle.js"></script>
<script src="bootstrap-filestyle-1.2.1/src/bootstrap-filestyle.min.js"></script>
<script src="bootstrap-slider/bootstrap-slider.js"></script>
<script>

    $( document ).ready(function() {
        //nascondo la select IR/RAMAN
        $('#select_ir_raman').hide();
    });

    //funzione che rende responsivo il plot di plotly
    window.onresize = function() {
        Plotly.Plots.resize(myDiv);
    };

    //funzione che legge i file caricati
    var openFile2 = function(e) {

        //usando jquery mostro la select IR/RAMAN
        $('#select_ir_raman').show();

        //imposto a true il flag che distingue tra caricamento da url e caricamento da tasto choosefile
        flagInputFile = true;

        //imposto a vuoto la variabile che contiene lo stile con un eventuale file .spt
        scr = "";

        var files = e.target.files;

        for (var i = 0; i < files.length; ++i) {

            var file = files[i];
            var data_filename = file.name;
            var file_ext = data_filename.split('.').pop();

            //lettura dei file .out oppure .xyz
            if (file_ext == 'out' || file_ext == 'xyz') {

                var reader = new FileReader();
                reader.onload = function(e) {
                    //estraggo i dati dal file
                    fileContent = e.target.result;

                    setParameters(file_ext);
                    Jmol.script(jmolApplet0, 'javascript init(scr); axes off; unitcell off;');
                    jmolIsReady();
                };
                reader.readAsText(file);
            }

            //lettura del file .spt
            if (file_ext == 'spt') {
                //info.script = "script "+ data_filename;
                //console.log(info);
                var reader = new FileReader();
                reader.onload = function(e) {
                    //estraggo i dati dal file
                    fileContent = e.target.result;

                    setParameters(file_ext);
                    scr = fileContent;
                };
                reader.readAsText(file);
            }
        }
    };
</script>
</html>

